<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Visiona Titan - Int√©gral</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #0f0f0f; --header: #0f0f0f; --text: #ffffff; --sec-text: #aaaaaa; 
            --hover: #272727; --blue: #3ea6ff; --red: #ff0000; --green: #00a854; 
            --gold: #ffc107; --glass: rgba(255,255,255,0.05);
        }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Roboto', sans-serif; overflow-x: hidden; transition: 0.3s; padding-bottom: 60px; }
        
        /* THEME NOEL */
        body.christmas { background: #002e17 !important; }
        body.christmas::before { content: "‚ùÑÔ∏è"; position: fixed; top: -20px; animation: snow 5s linear infinite; z-index: 9999; pointer-events: none; }
        @keyframes snow { to { transform: translateY(105vh); } }

        /* HEADER & NAVIGATION */
        header { display: flex; justify-content: space-between; align-items: center; padding: 0 16px; height: 56px; background: var(--header); position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #222; }
        .logo { font-size: 20px; font-weight: bold; cursor: pointer; display: flex; align-items: center; user-select: none; }
        .logo::before { content: '‚ñ∂'; color: var(--red); font-size: 24px; margin-right: 5px; }
        
        .search-box { display: flex; flex: 1; max-width: 600px; margin: 0 40px; }
        .search-box input { width: 100%; background: #121212; border: 1px solid #333; color: white; padding: 8px 16px; border-radius: 40px 0 0 40px; outline: none; }
        .search-box button { background: #222; border: 1px solid #333; border-left: none; color: white; padding: 0 20px; border-radius: 0 40px 40px 0; cursor: pointer; }

        .header-icons { display: flex; align-items: center; gap: 15px; }
        .icon-btn { background: none; border: none; color: white; font-size: 20px; cursor: pointer; position: relative; }
        .badge-count { position: absolute; top: -5px; right: -5px; background: var(--red); color: white; font-size: 10px; padding: 2px 5px; border-radius: 10px; }

        /* SIDEBAR ORIGINALE + EXTENSIONS */
        .container { display: flex; }
        .sidebar { width: 240px; height: calc(100vh - 56px); position: fixed; background: var(--bg); padding: 12px; border-right: 1px solid #222; overflow-y: auto; z-index: 900; }
        .nav-item { display: flex; align-items: center; padding: 10px 12px; border-radius: 10px; cursor: pointer; gap: 20px; transition: 0.2s; font-size: 14px; color: var(--text); text-decoration: none; }
        .nav-item:hover { background: var(--hover); }
        .nav-item.active { background: var(--hover); font-weight: 500; }

        /* MAIN CONTENT */
        .main-wrapper { margin-left: 240px; padding: 20px; flex: 1; transition: 0.3s; }
        .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }

        /* VIDEO CARDS */
        .v-card { cursor: pointer; transition: 0.3s; margin-bottom: 20px; }
        .v-thumb { width: 100%; aspect-ratio: 16/9; background: #222; border-radius: 12px; overflow: hidden; position: relative; }
        .v-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .v-duration { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); padding: 2px 4px; border-radius: 4px; font-size: 12px; }
        .live-tag { position: absolute; top: 8px; left: 8px; background: var(--red); padding: 2px 6px; border-radius: 4px; font-weight: bold; font-size: 12px; z-index: 2; }

        /* PROFIL TABS STYLE YOUTUBE */
        .banner { width: 100%; height: 200px; background: #333; border-radius: 15px; background-size: cover; background-position: center; margin-top: 10px; }
        .p-info { display: flex; align-items: center; gap: 20px; padding: 20px 0; }
        .p-avatar { width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--bg); object-fit: cover; }
        .p-tabs { display: flex; border-bottom: 1px solid #333; margin-bottom: 20px; position: sticky; top: 56px; background: var(--bg); z-index: 10; }
        .tab { padding: 12px 24px; cursor: pointer; font-weight: 500; color: var(--sec-text); border-bottom: 3px solid transparent; text-transform: uppercase; font-size: 14px; }
        .tab.active { color: white; border-bottom-color: white; }

        /* ZAPP (TIKTOK STYLE) */
        .zapp-container { display: none; height: calc(100vh - 120px); overflow-y: scroll; scroll-snap-type: y mandatory; max-width: 400px; margin: 0 auto; scrollbar-width: none; }
        .zapp-slide { height: 100%; scroll-snap-align: start; position: relative; background: black; border-radius: 15px; margin-bottom: 15px; overflow: hidden; }
        .zapp-video { width: 100%; height: 100%; object-fit: cover; }
        .zapp-ui { position: absolute; right: 10px; bottom: 60px; display: flex; flex-direction: column; gap: 25px; align-items: center; z-index: 5; }

        /* PLAYER OVERLAY */
        #player-overlay { display: none; position: fixed; inset: 0; background: var(--bg); z-index: 2000; overflow-y: auto; }
        .player-content { max-width: 1280px; margin: 0 auto; padding: 20px; display: grid; grid-template-columns: 1fr 350px; gap: 24px; }
        
        /* MODALS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 3000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: #212121; padding: 30px; border-radius: 16px; width: 95%; max-width: 550px; position: relative; max-height: 90vh; overflow-y: auto; }

        /* ADMIN BOXES */
        .admin-box { background: var(--hover); padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid var(--red); }

        /* MOBILE FIX */
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-wrapper { margin-left: 0; padding: 10px; }
            .player-content { grid-template-columns: 1fr; }
            .mobile-nav { display: flex !important; position: fixed; bottom: 0; width: 100%; background: #0f0f0f; border-top: 1px solid #222; height: 60px; justify-content: space-around; align-items: center; z-index: 1001; }
        }
        .mobile-nav { display: none; }
    </style>
</head>
<body id="main-body">
    <header>
        <div class="logo" onclick="app.eggClick()">Visiona</div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Rechercher une vid√©o, un auteur..." onkeyup="if(event.key==='Enter') app.search()">
            <button onclick="app.search()">üîç</button>
        </div>
        <div class="header-icons">
            <button class="icon-btn" onclick="app.openModal('modal-upload')" title="Mettre en ligne">‚ûï</button>
            <button class="icon-btn" onclick="app.toggleNotifs()" title="Notifications">
                üîî<span id="notif-count" class="badge-count" style="display:none;">0</span>
            </button>
            <div id="user-pdp-container" onclick="app.toggleUserMenu()" style="width:34px; height:34px; border-radius:50%; background:#444; cursor:pointer; overflow:hidden; border:1px solid #333;">
                <img id="my-avatar-top" src="" style="width:100%; height:100%; object-fit:cover; display:none;">
            </div>
        </div>
    </header>

    <div id="user-dropdown" style="display:none; position:fixed; right:16px; top:60px; background:#282828; border:1px solid #444; border-radius:12px; width:220px; z-index:2500; box-shadow:0 10px 20px rgba(0,0,0,0.5);">
        <div id="user-info-box" style="padding:15px; border-bottom:1px solid #444;">
            <b id="menu-user-name">Non connect√©</b>
        </div>
        <div class="nav-item" onclick="app.goMyProfile()">üë§ Ma cha√Æne</div>
        <div id="admin-link" class="nav-item" style="display:none; color:var(--red);" onclick="app.openModal('modal-admin')">üõ°Ô∏è Panel Admin</div>
        <div class="nav-item" onclick="app.logout()">üö™ D√©connexion</div>
    </div>

    <div class="container">
        <aside class="sidebar">
            <div class="nav-item active" onclick="app.nav('home')">üè† Accueil</div>
            <div class="nav-item" onclick="app.nav('zapp')">‚ö° Zapp (Shorts)</div>
            <div class="nav-item" onclick="app.nav('subs')">üîî Abonnements</div>
            <hr style="border:0; border-top:1px solid #333; margin:10px 0;">
            <div class="nav-item" onclick="app.nav('posts')">üìù Communaut√©</div>
            <div class="nav-item" onclick="app.openModal('modal-stream')">üî¥ Direct (Live)</div>
            <hr style="border:0; border-top:1px solid #333; margin:10px 0;">
            <div class="nav-item" onclick="app.nav('history')">üïí Historique</div>
            <div class="nav-item" onclick="app.nav('stats')">üìä Statistiques Titan</div>
            <div class="nav-item" onclick="app.nav('thanks')">üíé Remerciements</div>
            <hr style="border:0; border-top:1px solid #333; margin:10px 0;">
            <div id="sidebar-subs-list">
                </div>
        </aside>

        <main class="main-wrapper">
            <div id="annonce-banner"></div>

            <section id="view-home">
                <div class="video-grid" id="home-grid"></div>
            </section>

            <section id="view-zapp" class="zapp-container"></section>

            <section id="view-stats" style="display:none;">
                <div class="admin-box" style="border-left-color:var(--blue);">
                    <h2>üìä Tableau de bord Titan</h2>
                    <div id="stats-display" style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                        </div>
                </div>
            </section>

            <section id="view-profile" style="display:none;">
                <div id="prof-banner" class="banner"></div>
                <div class="p-info">
                    <img id="prof-avatar" class="p-avatar" src="">
                    <div style="flex:1">
                        <h1 id="prof-name" style="margin:0"></h1>
                        <p id="prof-stats-sub" style="color:var(--sec-text); margin:5px 0;"></p>
                    </div>
                    <div id="prof-action-btn"></div>
                </div>
                <div class="p-tabs">
                    <div class="tab active" onclick="app.switchTab('vids', this)">Vid√©os</div>
                    <div class="tab" onclick="app.switchTab('shorts', this)">Zapps</div>
                    <div class="tab" onclick="app.switchTab('posts', this)">Posts</div>
                    <div class="tab" onclick="app.switchTab('about', this)">√Ä propos</div>
                </div>
                <div id="profile-content" class="video-grid"></div>
            </section>

            <section id="view-thanks" style="display:none;">
                <h2>üíé Contributeurs & Remerciements</h2>
                <div id="thanks-grid" class="video-grid"></div>
            </section>
        </main>
    </div>

    <nav class="mobile-nav">
        <div onclick="app.nav('home')">üè†</div>
        <div onclick="app.nav('zapp')">‚ö°</div>
        <div onclick="app.nav('posts')">üìù</div>
        <div onclick="app.goMyProfile()">üë§</div>
    </nav>
    <div id="player-overlay">
        <div class="player-content">
            <div class="main-player-col">
                <div style="position: sticky; top: 10px;">
                    <button onclick="app.closePlayer()" style="background:rgba(255,255,255,0.1); border:none; color:white; padding:8px 15px; border-radius:20px; cursor:pointer; margin-bottom:15px;">‚úï Fermer la lecture</button>
                    
                    <video id="main-video" controls autoplay style="width:100%; aspect-ratio:16/9; background:black; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.5);"></video>
                    
                    <h2 id="video-title" style="margin:15px 0 10px 0; font-size:20px;">Titre de la vid√©o</h2>
                    
                    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px;">
                        <div style="display:flex; align-items:center; gap:12px;">
                            <img id="v-author-avatar" src="" style="width:40px; height:40px; border-radius:50%; background:#333; cursor:pointer;" onclick="app.goProfile(app.activeVid.author)">
                            <div>
                                <b id="v-author-name" style="cursor:pointer;" onclick="app.goProfile(app.activeVid.author)">Auteur</b>
                                <p id="v-author-subs" style="margin:0; font-size:12px; color:var(--sec-text);">0 abonn√©s</p>
                            </div>
                            <button id="v-sub-btn" onclick="app.toggleSub()" style="background:white; color:black; border:none; padding:8px 18px; border-radius:20px; font-weight:bold; margin-left:15px; cursor:pointer;">S'ABONNER</button>
                        </div>
                        
                        <div style="display:flex; gap:8px; background:var(--hover); padding:4px; border-radius:20px;">
                            <button onclick="app.handleVote('like')" class="icon-btn" style="padding:6px 15px; display:flex; align-items:center; gap:8px; border-right:1px solid #444;">
                                üëç <span id="v-likes">0</span>
                            </button>
                            <button onclick="app.handleVote('dislike')" class="icon-btn" style="padding:6px 15px;">
                                üëé <span id="v-dislikes">0</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="v-description-box" style="background:var(--hover); padding:12px; border-radius:12px; margin-top:15px; font-size:14px;">
                        <b id="v-views-date">0 vues ‚Ä¢ Il y a ...</b>
                        <p id="v-desc-text" style="white-space:pre-wrap; margin-top:8px;">Description de la vid√©o...</p>
                    </div>

                    <div style="margin-top:25px;">
                        <h3 id="comment-count-title">0 Commentaires</h3>
                        <div style="display:flex; gap:10px; margin-bottom:20px;">
                            <img id="my-comment-avatar" src="" style="width:40px; height:40px; border-radius:50%; background:#333;">
                            <div style="flex:1">
                                <input type="text" id="new-comment-input" placeholder="Ajouter un commentaire..." style="width:100%; background:none; border:none; border-bottom:1px solid #333; color:white; padding:8px 0; outline:none;">
                                <div style="display:flex; justify-content:flex-end; margin-top:8px;">
                                    <button onclick="app.postComment()" style="background:var(--blue); color:black; border:none; padding:8px 16px; border-radius:20px; font-weight:bold; cursor:pointer;">Commenter</button>
                                </div>
                            </div>
                        </div>
                        <div id="comments-list"></div>
                    </div>
                </div>
            </div>

            <div class="suggestions-col">
                <h4 style="margin-top:0;">Vid√©os sugg√©r√©es</h4>
                <div id="suggestions-grid"></div>
            </div>
        </div>
    </div>

    <div id="modal-auth" class="modal">
        <div class="modal-content">
            <h2 style="margin-top:0;">Bienvenue sur Visiona</h2>
            <p style="color:var(--sec-text);">Connectez-vous pour liker, commenter et publier.</p>
            <div style="margin:20px 0;">
                <input type="text" id="auth-username" placeholder="Pseudo" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; background:#121212; border:1px solid #333; color:white;">
                <input type="email" id="auth-email" placeholder="Email" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; background:#121212; border:1px solid #333; color:white;">
            </div>
            <button onclick="app.login()" style="width:100%; padding:12px; background:var(--blue); color:black; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">SE CONNECTER / S'INSCRIRE</button>
            <button onclick="app.closeModals()" style="width:100%; margin-top:10px; background:none; border:none; color:gray; cursor:pointer;">Plus tard</button>
        </div>
    </div>

    <div id="modal-upload" class="modal">
        <div class="modal-content">
            <h2 style="margin-top:0;">Publier du contenu</h2>
            <div style="max-height:60vh; overflow-y:auto; padding-right:10px;">
                <label>Titre de la vid√©o</label>
                <input type="text" id="upTitle" placeholder="Ex: Mon superbe vlog" style="width:100%; padding:12px; margin:8px 0 15px 0; border-radius:8px; background:#121212; border:1px solid #333; color:white;">
                
                <label>Description</label>
                <textarea id="upDesc" placeholder="Dites-en plus..." style="width:100%; height:80px; padding:12px; margin:8px 0 15px 0; border-radius:8px; background:#121212; border:1px solid #333; color:white; font-family:inherit;"></textarea>

                <label>Fichier Vid√©o (MP4, WebM...)</label>
                <input type="file" id="upVideoFile" accept="video/*" style="margin:8px 0 15px 0; color:var(--sec-text);">

                <label>Miniature (JPG, PNG...)</label>
                <input type="file" id="upThumbFile" accept="image/*" style="margin:8px 0 15px 0; color:var(--sec-text);">

                <div style="background:rgba(62,166,255,0.1); padding:10px; border-radius:8px; margin-bottom:15px;">
                    <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                        <input type="checkbox" id="upIsShort" style="width:18px; height:18px;">
                        <span>Publier en tant que ‚ö° Zapp (Format court)</span>
                    </label>
                </div>

                <p id="uploadStatus" style="font-size:13px; color:var(--blue); min-height:15px;"></p>
            </div>
            <div style="margin-top:20px;">
                <button onclick="app.publishVideo()" style="width:100%; padding:12px; background:var(--blue); color:black; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">D√âMARRER L'IMPORTATION</button>
                <button onclick="app.closeModals()" style="width:100%; margin-top:10px; background:none; border:none; color:gray; cursor:pointer;">Annuler</button>
            </div>
        </div>
    </div>

    <div id="modal-edit-profile" class="modal">
        <div class="modal-content">
            <h2>Personnaliser ma cha√Æne</h2>
            <div style="max-height:60vh; overflow-y:auto; padding-right:5px;">
                <label>Ma biographie</label>
                <textarea id="editBio" style="width:100%; height:80px; background:#121212; border:1px solid #333; color:white; border-radius:8px; padding:10px; margin-top:5px;"></textarea>
                
                <label style="display:block; margin-top:15px;">Photo de profil (Carr√© recommand√©)</label>
                <input type="file" id="editAvatarFile" accept="image/*" style="margin-top:5px;">

                <label style="display:block; margin-top:15px;">Banni√®re de cha√Æne</label>
                <input type="file" id="editBannerFile" accept="image/*" style="margin-top:5px;">

                <p id="profileUploadStatus" style="font-size:12px; color:var(--blue); margin-top:10px;"></p>
            </div>
            <button onclick="app.saveProfile()" style="width:100%; padding:12px; background:var(--green); color:white; border:none; border-radius:8px; font-weight:bold; margin-top:20px; cursor:pointer;">ENREGISTRER LES MODIFICATIONS</button>
            <button onclick="app.closeModals()" style="width:100%; margin-top:10px; background:none; border:none; color:gray; cursor:pointer;">Fermer</button>
        </div>
    </div>

    <div id="modal-admin" class="modal">
        <div class="modal-content" style="max-width:650px;">
            <h2 style="color:var(--red);">üõ°Ô∏è Panel de Contr√¥le Administrateur</h2>
            <div class="admin-tabs" style="display:flex; border-bottom:1px solid #333; margin-bottom:15px;">
                <div class="tab active" onclick="app.adminTab('annonces', this)">Annonces</div>
                <div class="tab" onclick="app.adminTab('users', this)">Utilisateurs</div>
                <div class="tab" onclick="app.adminTab('thanks', this)">Cr√©dits</div>
            </div>
            
            <div id="admin-panel-content">
                </div>
            
            <button onclick="app.closeModals()" style="width:100%; margin-top:20px; padding:10px; background:#333; border:none; color:white; border-radius:8px; cursor:pointer;">Quitter le panel</button>
        </div>
    </div>
    <script>
        // --- CONFIGURATION & √âTAT GLOBAL ---
        const GIST_URL = "https://gist.githubusercontent.com/AlphaGames30/5248424f9cc79feb78c0560faad87c92/raw/video.json";
        const WORKER = "https://mytubeupload.edonis-imbert.workers.dev/";

        const app = {
            data: { videos: [], users: {}, posts: [], thanks: [], annonces: [] },
            user: JSON.parse(localStorage.getItem('visiona_user')),
            stats: JSON.parse(localStorage.getItem('visiona_stats')) || { time: 0, views: 0, likes: 0, lastDaily: null },
            cooldowns: JSON.parse(localStorage.getItem('v_cd')) || {},
            activeVid: null,
            activeProfile: null,
            eggCount: 0,
            history: JSON.parse(localStorage.getItem('v_history')) || [],

            // --- 1. INITIALISATION ---
            init: async function() {
                console.log("Visiona Titan Loading...");
                await this.fetchData();
                this.updateUI();
                this.nav('home');
                this.startTimers();
                this.checkAnnonces();
                this.renderSubsSidebar();
                
                // Event listener pour fermer le menu au clic ailleurs
                window.onclick = (e) => {
                    if (!e.target.closest('#user-pdp-container') && !e.target.closest('#user-dropdown')) {
                        document.getElementById('user-dropdown').style.display = 'none';
                    }
                };
            },

            // --- 2. GESTION DES DONN√âES (GIST/WORKER) ---
            fetchData: async function() {
                try {
                    const r = await fetch(GIST_URL + "?t=" + Date.now());
                    if (!r.ok) throw new Error("Erreur Gist");
                    this.data = await r.json();
                    console.log("Data sync success");
                } catch(e) { 
                    console.error("Sync Error:", e);
                    alert("Erreur de connexion aux serveurs Visiona.");
                }
            },

            saveGist: async function() {
                if (!this.user) return;
                try {
                    const response = await fetch(WORKER, {
                        method: 'PATCH',
                        body: JSON.stringify({
                            files: { "video.json": { content: JSON.stringify(this.data, null, 2) } }
                        })
                    });
                    if (!response.ok) throw new Error("Worker Error");
                    console.log("Cloud Saved");
                } catch(e) {
                    console.error("Save Error:", e);
                }
            },

            // --- 3. NAVIGATION & VUES ---
            nav: function(viewId) {
                // Fermer le player si on navigue
                this.closePlayer();
                
                // Cacher toutes les sections
                const views = ['view-home', 'view-zapp', 'view-stats', 'view-profile', 'view-thanks'];
                views.forEach(v => document.getElementById(v).style.display = 'none');
                
                // Retirer la classe active de la sidebar
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));

                // Afficher la bonne vue
                const target = document.getElementById('view-' + viewId);
                if (target) {
                    target.style.display = (viewId === 'home') ? 'grid' : 'block';
                    if (viewId === 'home') this.renderHome();
                    if (viewId === 'zapp') this.renderZapp();
                    if (viewId === 'stats') this.renderStats();
                    if (viewId === 'thanks') this.renderThanks();
                }
            },

            // --- 4. INTERFACE UTILISATEUR (UI) ---
            updateUI: function() {
                if (this.user) {
                    const uData = this.data.users[this.user.name] || {};
                    document.getElementById('menu-user-name').innerText = this.user.name;
                    document.getElementById('my-avatar-top').src = uData.avatar || 'https://via.placeholder.com/34';
                    document.getElementById('my-avatar-top').style.display = 'block';
                    document.getElementById('my-comment-avatar').src = uData.avatar || 'https://via.placeholder.com/40';
                    
                    // V√©rification Admin (Edonis ou Admin)
                    if (this.user.name === "Admin" || this.user.email.includes("edonis")) {
                        document.getElementById('admin-link').style.display = 'flex';
                    }
                } else {
                    document.getElementById('my-avatar-top').style.display = 'none';
                }
            },

            toggleUserMenu: function() {
                const menu = document.getElementById('user-dropdown');
                menu.style.display = (menu.style.display === 'none') ? 'block' : 'none';
            },

            goMyProfile: function() {
                if (!this.user) return this.openModal('modal-auth');
                this.goProfile(this.user.name);
                document.getElementById('user-dropdown').style.display = 'none';
            },

            // --- 5. STATS & TIMERS ---
            startTimers: function() {
                // Timer de temps pass√© (Stats Titan)
                setInterval(() => {
                    this.stats.time += 10; // +10 secondes
                    localStorage.setItem('visiona_stats', JSON.stringify(this.stats));
                }, 10000);
            },

            renderStats: function() {
                const h = Math.floor(this.stats.time / 3600);
                const m = Math.floor((this.stats.time % 3600) / 60);
                const s = this.stats.time % 60;
                
                const display = document.getElementById('stats-display');
                display.innerHTML = `
                    <div class="admin-box" style="border-left-color:var(--gold);">
                        <h4 style="margin:0; color:var(--sec-text);">TEMPS DE VISIONNAGE</h4>
                        <p style="font-size:24px; font-weight:bold; margin:10px 0;">${h}h ${m}m ${s}s</p>
                    </div>
                    <div class="admin-box" style="border-left-color:var(--blue);">
                        <h4 style="margin:0; color:var(--sec-text);">VID√âOS VUES</h4>
                        <p style="font-size:24px; font-weight:bold; margin:10px 0;">${this.stats.views}</p>
                    </div>
                    <div class="admin-box" style="border-left-color:var(--red);">
                        <h4 style="margin:0; color:var(--sec-text);">LIKES DONN√âS</h4>
                        <p style="font-size:24px; font-weight:bold; margin:10px 0;">${this.stats.likes}</p>
                    </div>
                    <div class="admin-box" style="border-left-color:var(--green);">
                        <h4 style="margin:0; color:var(--sec-text);">NIVEAU TITAN</h4>
                        <p style="font-size:24px; font-weight:bold; margin:10px 0;">${this.getTitanRank()}</p>
                    </div>
                `;
            },

            getTitanRank: function() {
                if (this.stats.views > 100) return "DIAMANT üíé";
                if (this.stats.views > 50) return "OR ü•á";
                if (this.stats.views > 10) return "ARGENT ü•à";
                return "BRONZE ü•â";
            },

            // --- 6. RECHERCHE ---
            search: function() {
                const q = document.getElementById('searchInput').value.toLowerCase();
                if (!q) return this.renderHome();
                
                const results = this.data.videos.filter(v => 
                    v.title.toLowerCase().includes(q) || 
                    v.author.toLowerCase().includes(q)
                );
                
                this.nav('home');
                const grid = document.getElementById('home-grid');
                grid.innerHTML = results.length > 0 
                    ? results.map(v => this.createVideoCard(v)).join('') 
                    : `<div style="grid-column: 1/-1; text-align:center; padding:50px;">Aucun r√©sultat pour "${q}"</div>`;
            },
            // --- 7. RENDU DES VID√âOS (HOME) ---
            renderHome: function() {
                const grid = document.getElementById('home-grid');
                if (!grid) return;
                
                // On trie par date (les plus r√©centes en premier)
                const vids = [...this.data.videos].filter(v => !v.isShort).sort((a,b) => b.id - a.id);
                
                grid.innerHTML = vids.map(v => this.createVideoCard(v)).join('');
            },

            createVideoCard: function(v) {
                const authorData = this.data.users[v.author] || {};
                const isLive = v.isLive ? '<div class="live-tag">DIRECT</div>' : '';
                
                return `
                    <div class="v-card" onclick="app.openPlayer('${v.id}')">
                        <div class="v-thumb">
                            <img src="${v.thumb}" loading="lazy">
                            ${isLive}
                            <div class="v-duration">${v.duration || '10:00'}</div>
                        </div>
                        <div style="display:flex; gap:12px; margin-top:12px;">
                            <img src="${authorData.avatar || 'https://via.placeholder.com/36'}" 
                                 style="width:36px; height:36px; border-radius:50%; object-fit:cover;" 
                                 onclick="event.stopPropagation(); app.goProfile('${v.author}')">
                            <div style="overflow:hidden;">
                                <b style="display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; line-height:1.2;" title="${v.title}">${v.title}</b>
                                <p style="font-size:12px; color:var(--sec-text); margin:4px 0;" onclick="event.stopPropagation(); app.goProfile('${v.author}')">${v.author}</p>
                                <p style="font-size:12px; color:var(--sec-text);">${v.views || 0} vues ‚Ä¢ ${this.timeAgo(v.id.toString().split('_')[1] || Date.now())}</p>
                            </div>
                        </div>
                    </div>`;
            },

            // --- 8. SYST√àME DE VUES (AVEC COOLDOWN 1H) ---
            addView: function(id) {
                const now = Date.now();
                // Cooldown par vid√©o : 1 vue max par heure par utilisateur local
                if (!this.cooldowns[id] || (now - this.cooldowns[id] > 3600000)) {
                    const v = this.data.videos.find(x => x.id == id);
                    if (v) {
                        v.views = (v.views || 0) + 1;
                        this.cooldowns[id] = now;
                        localStorage.setItem('v_cd', JSON.stringify(this.cooldowns));
                        
                        // Update stats globales Titan
                        this.stats.views++;
                        localStorage.setItem('visiona_stats', JSON.stringify(this.stats));
                        
                        this.saveGist(); // Sauvegarde sur le Cloud
                    }
                }
            },

            // --- 9. LECTEUR VID√âO (PLAYER) ---
            openPlayer: function(id) {
                const v = this.data.videos.find(x => x.id == id);
                if (!v) return;
                this.activeVid = v;
                
                const overlay = document.getElementById('player-overlay');
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Stop scroll fond
                
                const player = document.getElementById('main-video');
                player.src = v.url;
                player.play();
                
                // Remplissage des infos
                document.getElementById('video-title').innerText = v.title;
                document.getElementById('v-desc-text').innerText = v.description || "Aucune description.";
                document.getElementById('v-views-date').innerText = `${v.views || 0} vues ‚Ä¢ ${this.timeAgo(v.id.toString().split('_')[1] || Date.now())}`;
                
                // Infos Auteur
                const auth = this.data.users[v.author] || { name: v.author };
                document.getElementById('v-author-name').innerText = v.author;
                document.getElementById('v-author-avatar').src = auth.avatar || 'https://via.placeholder.com/40';
                document.getElementById('v-author-subs').innerText = `${this.countSubs(v.author)} abonn√©s`;
                
                // UI Boutons
                this.updatePlayerUI();
                this.renderComments();
                this.renderSuggestions();
                this.addView(id);
            },

            closePlayer: function() {
                const player = document.getElementById('main-video');
                player.pause();
                player.src = "";
                document.getElementById('player-overlay').style.display = 'none';
                document.body.style.overflow = 'auto';
            },

            // --- 10. INTERACTIONS (LIKE / SUB) ---
            handleVote: function(type) {
                if (!this.user) return this.openModal('modal-auth');
                const v = this.activeVid;
                if (!v.voters) v.voters = {};

                const currentVote = v.voters[this.user.name];

                if (currentVote === type) {
                    // Annuler le vote
                    delete v.voters[this.user.name];
                    type === 'like' ? v.likes-- : v.dislikes--;
                } else {
                    // Changer de vote ou nouveau vote
                    if (currentVote) {
                        currentVote === 'like' ? v.likes-- : v.dislikes--;
                    }
                    v.voters[this.user.name] = type;
                    type === 'like' ? v.likes++ : v.dislikes++;
                    
                    if (type === 'like') this.stats.likes++;
                }

                this.updatePlayerUI();
                this.saveGist();
            },

            toggleSub: function() {
                if (!this.user) return this.openModal('modal-auth');
                if (this.user.name === this.activeVid.author) return alert("Vous ne pouvez pas vous abonner √† vous-m√™me !");

                const me = this.data.users[this.user.name];
                if (!me.subs) me.subs = {};

                if (me.subs[this.activeVid.author]) {
                    delete me.subs[this.activeVid.author];
                } else {
                    me.subs[this.activeVid.author] = Date.now();
                }

                this.updatePlayerUI();
                this.renderSubsSidebar();
                this.saveGist();
            },

            updatePlayerUI: function() {
                const v = this.activeVid;
                document.getElementById('v-likes').innerText = v.likes || 0;
                document.getElementById('v-dislikes').innerText = v.dislikes || 0;
                
                const btn = document.getElementById('v-sub-btn');
                if (this.user && this.data.users[this.user.name]?.subs?.[v.author]) {
                    btn.innerText = "ABONN√â";
                    btn.style.background = "var(--hover)";
                    btn.style.color = "white";
                } else {
                    btn.innerText = "S'ABONNER";
                    btn.style.background = "white";
                    btn.style.color = "black";
                }
            },

            countSubs: function(authorName) {
                return Object.values(this.data.users).filter(u => u.subs && u.subs[authorName]).length;
            },

            // --- UTILITAIRE TEMPS ---
            timeAgo: function(timestamp) {
                const seconds = Math.floor((new Date() - timestamp) / 1000);
                let interval = seconds / 31536000;
                if (interval > 1) return "il y a " + Math.floor(interval) + " ans";
                interval = seconds / 2592000;
                if (interval > 1) return "il y a " + Math.floor(interval) + " mois";
                interval = seconds / 86400;
                if (interval > 1) return "il y a " + Math.floor(interval) + " jours";
                interval = seconds / 3600;
                if (interval > 1) return "il y a " + Math.floor(interval) + " heures";
                interval = seconds / 60;
                if (interval > 1) return "il y a " + Math.floor(interval) + " minutes";
                return "il y a quelques secondes";
            },
            // --- 11. SYST√àME DE COMMENTAIRES TITAN ---
            renderComments: function() {
                const container = document.getElementById('comments-list');
                const v = this.activeVid;
                if (!v.comments) v.comments = [];

                document.getElementById('comment-count-title').innerText = `${v.comments.length} Commentaires`;

                container.innerHTML = v.comments.map((c, index) => {
                    const isAuthor = c.author === v.author;
                    const hasHeart = c.hasHeart ? `<img src="${this.data.users[v.author]?.avatar || ''}" style="width:16px; height:16px; border-radius:50%; position:absolute; bottom:-5px; right:-5px; border:2px solid #0f0f0f;">` : '';
                    const authorBadge = isAuthor ? `<span style="background:#888; color:white; padding:1px 6px; border-radius:10px; font-size:11px; margin-left:5px;">Auteur</span>` : '';
                    
                    return `
                    <div style="display:flex; gap:12px; margin-bottom:20px; position:relative;">
                        <div style="position:relative; width:40px; height:40px;">
                            <img src="${this.data.users[c.author]?.avatar || 'https://via.placeholder.com/40'}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">
                            ${hasHeart ? `<div style="position:absolute; bottom:-2px; right:-2px; background:red; border-radius:50%; width:18px; height:18px; display:flex; align-items:center; justify-content:center; border:2px solid #0f0f0f;">‚ù§Ô∏è</div>` : ''}
                        </div>
                        <div style="flex:1">
                            <div style="display:flex; align-items:center; gap:8px;">
                                <b style="font-size:13px;">@${c.author}</b>
                                ${authorBadge}
                                <span style="color:var(--sec-text); font-size:12px;">${this.timeAgo(c.date)}</span>
                            </div>
                            <p style="margin:5px 0; font-size:14px;">${c.text}</p>
                            <div style="display:flex; align-items:center; gap:15px; margin-top:5px;">
                                <button style="background:none; border:none; color:var(--sec-text); cursor:pointer; font-size:12px;">üëç</button>
                                <button style="background:none; border:none; color:var(--sec-text); cursor:pointer; font-size:12px;">R√©pondre</button>
                                ${this.user && this.user.name === v.author ? 
                                    `<button onclick="app.toggleHeart(${index})" style="background:none; border:none; color:var(--red); cursor:pointer; font-size:12px;">‚ù§Ô∏è Offrir un c≈ìur</button>` : ''}
                            </div>
                        </div>
                    </div>`;
                }).join('');
            },

            postComment: async function() {
                if (!this.user) return this.openModal('modal-auth');
                const input = document.getElementById('new-comment-input');
                const text = input.value.trim();
                if (!text) return;

                const newComment = {
                    author: this.user.name,
                    text: text,
                    date: Date.now(),
                    hasHeart: false
                };

                this.activeVid.comments.unshift(newComment);
                input.value = "";
                this.renderComments();
                await this.saveGist();
            },

            toggleHeart: async function(index) {
                const comment = this.activeVid.comments[index];
                comment.hasHeart = !comment.hasHeart;
                this.renderComments();
                await this.saveGist();
            },

            // --- 12. SYST√àME DE ZAPP (SHORTS) ---
            renderZapp: function() {
                const container = document.getElementById('view-zapp');
                const zapps = this.data.videos.filter(v => v.isShort);
                
                if (zapps.length === 0) {
                    container.innerHTML = `<div style="text-align:center; padding-top:100px;">Aucun Zapp disponible pour le moment.</div>`;
                    return;
                }

                container.innerHTML = zapps.map(z => `
                    <div class="zapp-slide">
                        <video class="zapp-video" src="${z.url}" loop onclick="this.paused ? this.play() : this.pause()"></video>
                        <div class="zapp-ui">
                            <div onclick="app.goProfile('${z.author}')" style="cursor:pointer;">
                                <img src="${this.data.users[z.author]?.avatar || ''}" style="width:45px; height:45px; border-radius:50%; border:2px solid white;">
                            </div>
                            <div onclick="app.handleVote('like')" style="text-align:center; cursor:pointer;">
                                <span style="font-size:28px;">‚ù§Ô∏è</span><br><small>${z.likes || 0}</small>
                            </div>
                            <div onclick="app.openPlayer('${z.id}')" style="text-align:center; cursor:pointer;">
                                <span style="font-size:28px;">üí¨</span><br><small>${z.comments?.length || 0}</small>
                            </div>
                            <div style="text-align:center; cursor:pointer;">
                                <span style="font-size:28px;">üì§</span>
                            </div>
                        </div>
                        <div style="position:absolute; bottom:20px; left:15px; right:70px; text-shadow:2px 2px 4px rgba(0,0,0,0.8);">
                            <b style="font-size:18px;">@${z.author}</b>
                            <p style="margin:5px 0; font-size:14px;">${z.title}</p>
                        </div>
                    </div>
                `).join('');
                
                // Auto-play du premier zapp
                const firstVideo = container.querySelector('video');
                if (firstVideo) firstVideo.play();
            },

            // --- 13. ADMINISTRATION (ANNONCES & THANKS) ---
            adminTab: function(tab, el) {
                document.querySelectorAll('.admin-tabs .tab').forEach(t => t.classList.remove('active'));
                el.classList.add('active');
                const content = document.getElementById('admin-panel-content');

                if (tab === 'annonces') {
                    content.innerHTML = `
                        <div style="margin-top:15px;">
                            <label>Nouvelle Annonce Globale</label>
                            <textarea id="adm-ann-text" style="width:100%; height:80px; background:#121212; border:1px solid #333; color:white; border-radius:8px; padding:10px; margin:10px 0;"></textarea>
                            <button onclick="app.postAnnounce()" style="background:var(--red); color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold;">DIFFUSER L'ANNONCE</button>
                        </div>
                    `;
                } else if (tab === 'users') {
                    const userList = Object.keys(this.data.users).map(u => `
                        <div style="display:flex; justify-content:space-between; align-items:center; background:#1a1a1a; padding:10px; border-radius:8px; margin-bottom:5px;">
                            <span>${u}</span>
                            <button onclick="app.banUser('${u}')" style="background:var(--red); border:none; color:white; padding:5px 10px; border-radius:4px; cursor:pointer;">Bannir</button>
                        </div>
                    `).join('');
                    content.innerHTML = `<div style="margin-top:15px;">${userList}</div>`;
                } else if (tab === 'thanks') {
                    content.innerHTML = `
                        <div style="margin-top:15px;">
                            <input type="text" id="adm-thx-name" placeholder="Nom du contributeur" style="width:100%; padding:10px; background:#121212; border:1px solid #333; color:white; border-radius:8px; margin-bottom:10px;">
                            <input type="text" id="adm-thx-role" placeholder="R√¥le (ex: Donateur)" style="width:100%; padding:10px; background:#121212; border:1px solid #333; color:white; border-radius:8px; margin-bottom:10px;">
                            <button onclick="app.addThanks()" style="background:var(--green); color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold;">AJOUTER AUX CR√âDITS</button>
                        </div>
                    `;
                }
            },

            postAnnounce: async function() {
                const text = document.getElementById('adm-ann-text').value;
                if (!text) return;
                this.data.annonces = [{ text: text, date: Date.now() }];
                await this.saveGist();
                alert("Annonce publi√©e !");
                this.checkAnnonces();
            },

            checkAnnonces: function() {
                const banner = document.getElementById('annonce-banner');
                if (this.data.annonces && this.data.annonces.length > 0) {
                    banner.innerHTML = `
                        <div style="background:rgba(255,0,0,0.15); border:1px solid var(--red); color:white; padding:15px; border-radius:12px; margin-bottom:20px; display:flex; align-items:center; gap:15px;">
                            <span style="font-size:24px;">üì¢</span>
                            <div>
                                <b style="color:var(--red);">ANNONCE OFFICIELLE</b><br>
                                <span>${this.data.annonces[0].text}</span>
                            </div>
                        </div>
                    `;
                } else {
                    banner.innerHTML = "";
                }
            },
            // --- 14. AUTHENTIFICATION (LOGIN / REGISTER) ---
            login: async function() {
                const name = document.getElementById('auth-username').value.trim();
                const email = document.getElementById('auth-email').value.trim();
                if (!name || !email) return alert("Veuillez remplir tous les champs.");

                this.user = { name, email };
                localStorage.setItem('visiona_user', JSON.stringify(this.user));

                // Cr√©er l'utilisateur dans la base s'il n'existe pas
                if (!this.data.users[name]) {
                    this.data.users[name] = {
                        avatar: "",
                        banner: "",
                        bio: "Nouveau membre Visiona",
                        joined: Date.now(),
                        subs: {}
                    };
                    await this.saveGist();
                }

                this.updateUI();
                this.closeModals();
                location.reload(); // Refresh pour appliquer les changements
            },

            logout: function() {
                localStorage.removeItem('visiona_user');
                location.reload();
            },

            // --- 15. MOTEUR D'UPLOAD (CLOUDINARY) ---
            uploadCloudinary: async function(file, type) {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', 'visiona_preset'); // Preset Cloudinary requis
                
                try {
                    const res = await fetch(`https://api.cloudinary.com/v1_1/dbx6v6szb/${type}/upload`, {
                        method: 'POST',
                        body: formData
                    });
                    const json = await res.json();
                    return json.secure_url;
                } catch (e) {
                    console.error("Upload Error:", e);
                    return null;
                }
            },

            publishVideo: async function() {
                if (!this.user) return this.openModal('modal-auth');
                
                const title = document.getElementById('upTitle').value;
                const desc = document.getElementById('upDesc').value;
                const videoFile = document.getElementById('upVideoFile').files[0];
                const thumbFile = document.getElementById('upThumbFile').files[0];
                const isShort = document.getElementById('upIsShort').checked;
                const status = document.getElementById('uploadStatus');

                if (!title || !videoFile) return alert("Le titre et la vid√©o sont obligatoires.");

                status.innerText = "‚è≥ Initialisation de l'importation...";
                
                try {
                    status.innerText = "üöÄ Upload de la vid√©o (cela peut prendre du temps)...";
                    const videoUrl = await this.uploadCloudinary(videoFile, 'video');
                    
                    let thumbUrl = "https://via.placeholder.com/800x450?text=Visiona";
                    if (thumbFile) {
                        status.innerText = "üì∏ Upload de la miniature...";
                        thumbUrl = await this.uploadCloudinary(thumbFile, 'image');
                    }

                    const newVideo = {
                        id: "v_" + Date.now(),
                        title: title,
                        description: desc,
                        url: videoUrl,
                        thumb: thumbUrl,
                        author: this.user.name,
                        views: 0,
                        likes: 0,
                        dislikes: 0,
                        isShort: isShort,
                        date: Date.now(),
                        comments: []
                    };

                    this.data.videos.unshift(newVideo);
                    await this.saveGist();
                    
                    status.innerText = "‚úÖ Publication r√©ussie !";
                    setTimeout(() => location.reload(), 2000);
                } catch (e) {
                    status.innerText = "‚ùå Erreur lors de l'importation.";
                    console.error(e);
                }
            },

            // --- 16. GESTION DU PROFIL (√âDITION) ---
            saveProfile: async function() {
                const bio = document.getElementById('editBio').value;
                const pp = document.getElementById('editAvatarFile').files[0];
                const ban = document.getElementById('editBannerFile').files[0];
                const status = document.getElementById('profileUploadStatus');
                
                status.innerText = "‚è≥ Mise √† jour en cours...";
                const userData = this.data.users[this.user.name];

                try {
                    if (pp) userData.avatar = await this.uploadCloudinary(pp, 'image');
                    if (ban) userData.banner = await this.uploadCloudinary(ban, 'image');
                    userData.bio = bio;

                    await this.saveGist();
                    status.innerText = "‚úÖ Profil mis √† jour !";
                    setTimeout(() => location.reload(), 1500);
                } catch (e) {
                    status.innerText = "‚ùå Erreur de mise √† jour.";
                }
            },

            // --- 17. PROFIL (RENDU PUBLIC & ONGLETS) ---
            goProfile: function(name) {
                this.nav('profile');
                this.activeProfile = name;
                const u = this.data.users[name] || { name: name, bio: "Utilisateur" };
                
                document.getElementById('prof-name').innerText = name;
                document.getElementById('prof-avatar').src = u.avatar || 'https://via.placeholder.com/120';
                document.getElementById('prof-banner').style.backgroundImage = u.banner ? `url(${u.banner})` : "linear-gradient(45deg, #222, #444)";
                document.getElementById('prof-stats-sub').innerText = `${this.countSubs(name)} abonn√©s ‚Ä¢ ${this.data.videos.filter(v=>v.author===name).length} vid√©os`;
                
                // Bouton S'abonner ou Modifier
                const btnArea = document.getElementById('prof-action-btn');
                if (this.user && this.user.name === name) {
                    btnArea.innerHTML = `<button onclick="app.openModal('modal-edit-profile')" style="background:var(--hover); color:white; border:none; padding:10px 20px; border-radius:20px; font-weight:bold; cursor:pointer;">PERSONNALISER LA CHA√éNE</button>`;
                    document.getElementById('editBio').value = u.bio || "";
                } else {
                    btnArea.innerHTML = `<button onclick="app.toggleSub()" style="background:white; color:black; border:none; padding:10px 20px; border-radius:20px; font-weight:bold; cursor:pointer;">S'ABONNER</button>`;
                }

                this.switchTab('vids', document.querySelector('.p-tabs .tab'));
            },

            switchTab: function(type, el) {
                document.querySelectorAll('.p-tabs .tab').forEach(t => t.classList.remove('active'));
                el.classList.add('active');
                const content = document.getElementById('profile-content');
                const vids = this.data.videos.filter(v => v.author === this.activeProfile);

                if (type === 'vids') {
                    content.innerHTML = vids.filter(v => !v.isShort).map(v => this.createVideoCard(v)).join('');
                } else if (type === 'shorts') {
                    content.innerHTML = vids.filter(v => v.isShort).map(v => this.createVideoCard(v)).join('');
                } else if (type === 'posts') {
                    const posts = this.data.posts.filter(p => p.author === this.activeProfile);
                    content.innerHTML = posts.length ? posts.map(p => `<div class="admin-box">${p.text}</div>`).join('') : "<p>Aucun post communautaire.</p>";
                } else if (type === 'about') {
                    const u = this.data.users[this.activeProfile] || {};
                    content.innerHTML = `<div class="admin-box"><h3>Description</h3><p>${u.bio || "Aucune description fournie."}</p></div>`;
                }
            },

            // --- 18. DIVERS & FINALISATION ---
            renderThanks: function() {
                const grid = document.getElementById('thanks-grid');
                grid.innerHTML = (this.data.thanks || []).map(t => `
                    <div class="admin-box" style="text-align:center; border-left:none; border-top:4px solid var(--blue);">
                        <h3 style="margin:0;">${t.name}</h3>
                        <p style="color:var(--blue);">${t.role}</p>
                    </div>
                `).join('');
            },

            renderSuggestions: function() {
                const grid = document.getElementById('suggestions-grid');
                const suggestions = this.data.videos.filter(v => v.id !== this.activeVid.id).slice(0, 10);
                grid.innerHTML = suggestions.map(v => `
                    <div style="display:flex; gap:10px; margin-bottom:12px; cursor:pointer;" onclick="app.openPlayer('${v.id}')">
                        <img src="${v.thumb}" style="width:140px; aspect-ratio:16/9; border-radius:8px; object-fit:cover;">
                        <div>
                            <b style="font-size:13px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;">${v.title}</b>
                            <p style="font-size:11px; color:var(--sec-text); margin:4px 0;">${v.author}</p>
                            <p style="font-size:11px; color:var(--sec-text);">${v.views || 0} vues</p>
                        </div>
                    </div>
                `).join('');
            },

            eggClick: function() {
                this.eggCount++;
                if (this.eggCount >= 10) {
                    document.body.classList.toggle('christmas');
                    alert("üéÖ Mode No√´l Visiona Activ√© !");
                    this.eggCount = 0;
                }
            }
        };

        // LANCEMENT DE L'APPLICATION
        app.init();
    </script>
</body>
</html>
